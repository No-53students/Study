# ç§»åŠ¨ç«¯è·¯ç”±ç³»ç»Ÿé‡æ–°è®¾è®¡

## ä¸€ã€è®¾è®¡åŸåˆ™

> **æ ¸å¿ƒç†å¿µï¼šç§»åŠ¨ç«¯ç©ºé—´å®è´µï¼Œåªä¿ç•™ä¸€ä¸ªæ™ºèƒ½å¯¼èˆª**

### è®¾è®¡ç›®æ ‡

1. **å•ä¸€å¯¼èˆª** - åº•éƒ¨ä¸€ä¸ªå¯¼èˆªæ è§£å†³æ‰€æœ‰å¯¼èˆªéœ€æ±‚
2. **æ™ºèƒ½é€‚åº”** - æ ¹æ®å½“å‰é¡µé¢æ·±åº¦è‡ªåŠ¨åˆ‡æ¢å¯¼èˆªæ¨¡å¼
3. **æ‰‹åŠ¿ä¼˜å…ˆ** - å……åˆ†åˆ©ç”¨æ»‘åŠ¨æ‰‹åŠ¿å‡å°‘ç‚¹å‡»
4. **å†…å®¹ä¼˜å…ˆ** - æœ€å¤§åŒ–å†…å®¹å±•ç¤ºç©ºé—´

---

## äºŒã€æ™ºèƒ½åº•éƒ¨å¯¼èˆª

### 2.1 å¯¼èˆªæ¨¡å¼è‡ªåŠ¨åˆ‡æ¢

```
æ¨¡å¼ A: ä¸»å¯¼èˆªæ¨¡å¼ (ä¸€çº§é¡µé¢)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            é¡µé¢å†…å®¹åŒºåŸŸ              â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ é¦–é¡µ    ğŸ“šå­¦ä¹     ğŸ’»åˆ·é¢˜    ğŸ‘¤æˆ‘çš„  â”‚  â† 4 ä¸ªä¸» Tab
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ¨¡å¼ B: ä¸Šä¸‹æ–‡æ¨¡å¼ (äºŒçº§åŠä»¥ä¸‹é¡µé¢)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            é¡µé¢å†…å®¹åŒºåŸŸ              â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â† è¿”å›    useState    ä¸Šä¸€ä¸ª | ä¸‹ä¸€ä¸ª â”‚  â† æ™ºèƒ½ä¸Šä¸‹æ–‡å¯¼èˆª
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 é¡µé¢å±‚çº§

```
ä¸€çº§é¡µé¢ â†’ æ˜¾ç¤ºä¸» Tab å¯¼èˆª
â”œâ”€â”€ /                 é¦–é¡µ
â”œâ”€â”€ /learn            å­¦ä¹ ä¸­å¿ƒ (React + ç®—æ³•)
â”œâ”€â”€ /problems         åˆ·é¢˜ä¸­å¿ƒ
â””â”€â”€ /profile          æˆ‘çš„

äºŒçº§åŠä»¥ä¸‹ â†’ æ˜¾ç¤ºä¸Šä¸‹æ–‡å¯¼èˆª
â”œâ”€â”€ /use-state        Hook è¯¦æƒ… (â† è¿”å› | æ ‡é¢˜ | ä¸Š/ä¸‹ä¸€ä¸ª)
â”œâ”€â”€ /problems/two-sum é¢˜ç›®è¯¦æƒ… (â† è¿”å› | æ ‡é¢˜ | ä¸Š/ä¸‹ä¸€é¢˜)
â””â”€â”€ ...
```

---

## ä¸‰ã€æ ¸å¿ƒç»„ä»¶ï¼šæ™ºèƒ½åº•éƒ¨å¯¼èˆª

```tsx
// components/navigation/SmartBottomNav.tsx
"use client";

import { usePathname, useRouter } from "next/navigation";
import { motion, AnimatePresence } from "framer-motion";
import { useMemo } from "react";

// ä¸€çº§é¡µé¢è·¯å¾„
const PRIMARY_PATHS = ["/", "/learn", "/problems", "/profile"];

// ä¸»å¯¼èˆªé…ç½®
const mainTabs = [
  { id: "home", label: "é¦–é¡µ", path: "/", icon: "ğŸ " },
  { id: "learn", label: "å­¦ä¹ ", path: "/learn", icon: "ğŸ“š" },
  { id: "practice", label: "åˆ·é¢˜", path: "/problems", icon: "ğŸ’»" },
  { id: "profile", label: "æˆ‘çš„", path: "/profile", icon: "ğŸ‘¤" },
];

// è·å–åŒçº§é¡µé¢ï¼ˆç”¨äºä¸Šä¸‹åˆ‡æ¢ï¼‰
function getSiblings(pathname: string): { prev?: string; next?: string; title: string } {
  // è¿™é‡Œæ ¹æ®å®é™…è·¯ç”±é…ç½®è¿”å›åŒçº§é¡µé¢
  // ç¤ºä¾‹ï¼šHooks ç³»åˆ—
  const hooksList = [
    { path: "/use-state", title: "useState" },
    { path: "/use-effect", title: "useEffect" },
    { path: "/use-ref", title: "useRef" },
    // ...
  ];

  const currentIndex = hooksList.findIndex(h => pathname === h.path);
  if (currentIndex !== -1) {
    return {
      prev: hooksList[currentIndex - 1]?.path,
      next: hooksList[currentIndex + 1]?.path,
      title: hooksList[currentIndex].title,
    };
  }

  // é¢˜ç›®ç³»åˆ—ç±»ä¼¼å¤„ç†...
  return { title: "è¯¦æƒ…" };
}

export function SmartBottomNav() {
  const pathname = usePathname();
  const router = useRouter();

  // åˆ¤æ–­æ˜¯å¦ä¸ºä¸€çº§é¡µé¢
  const isPrimaryPage = useMemo(() => {
    return PRIMARY_PATHS.includes(pathname) ||
           PRIMARY_PATHS.some(p => p !== "/" && pathname === p);
  }, [pathname]);

  // è·å–åŒçº§å¯¼èˆªä¿¡æ¯
  const siblings = useMemo(() => getSiblings(pathname), [pathname]);

  return (
    <nav className="fixed bottom-0 inset-x-0 z-50 md:hidden">
      <div className="bg-zinc-900/95 backdrop-blur-xl border-t border-zinc-800">
        <AnimatePresence mode="wait">
          {isPrimaryPage ? (
            // æ¨¡å¼ A: ä¸» Tab å¯¼èˆª
            <motion.div
              key="main-nav"
              initial={{ opacity: 0, y: 10 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: -10 }}
              className="grid grid-cols-4 h-14 pb-[env(safe-area-inset-bottom)]"
            >
              {mainTabs.map((tab) => {
                const isActive = pathname === tab.path ||
                  (tab.path !== "/" && pathname.startsWith(tab.path));

                return (
                  <button
                    key={tab.id}
                    onClick={() => router.push(tab.path)}
                    className={`flex flex-col items-center justify-center gap-0.5
                      ${isActive ? "text-white" : "text-zinc-500"}`}
                  >
                    <span className="text-xl">{tab.icon}</span>
                    <span className="text-[10px] font-medium">{tab.label}</span>
                  </button>
                );
              })}
            </motion.div>
          ) : (
            // æ¨¡å¼ B: ä¸Šä¸‹æ–‡å¯¼èˆª
            <motion.div
              key="context-nav"
              initial={{ opacity: 0, y: 10 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: -10 }}
              className="flex items-center h-14 px-4 pb-[env(safe-area-inset-bottom)]"
            >
              {/* è¿”å›æŒ‰é’® */}
              <button
                onClick={() => router.back()}
                className="flex items-center gap-1 px-3 py-2 -ml-3 rounded-lg active:bg-zinc-800"
              >
                <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                  <path strokeLinecap="round" strokeLinejoin="round" d="M15 19l-7-7 7-7" />
                </svg>
                <span className="text-sm">è¿”å›</span>
              </button>

              {/* å½“å‰é¡µé¢æ ‡é¢˜ */}
              <div className="flex-1 text-center">
                <span className="text-sm font-medium truncate">{siblings.title}</span>
              </div>

              {/* ä¸Š/ä¸‹ä¸€ä¸ªåˆ‡æ¢ */}
              <div className="flex items-center gap-1">
                <button
                  onClick={() => siblings.prev && router.push(siblings.prev)}
                  disabled={!siblings.prev}
                  className={`p-2 rounded-lg ${siblings.prev ? "active:bg-zinc-800" : "opacity-30"}`}
                >
                  <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                    <path strokeLinecap="round" strokeLinejoin="round" d="M15 19l-7-7 7-7" />
                  </svg>
                </button>
                <button
                  onClick={() => siblings.next && router.push(siblings.next)}
                  disabled={!siblings.next}
                  className={`p-2 rounded-lg ${siblings.next ? "active:bg-zinc-800" : "opacity-30"}`}
                >
                  <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                    <path strokeLinecap="round" strokeLinejoin="round" d="M9 5l7 7-7 7" />
                  </svg>
                </button>
              </div>
            </motion.div>
          )}
        </AnimatePresence>
      </div>
    </nav>
  );
}
```

---

## å››ã€æ‰‹åŠ¿æ”¯æŒ

### 4.1 å·¦å³æ»‘åŠ¨åˆ‡æ¢

åœ¨è¯¦æƒ…é¡µæ”¯æŒå·¦å³æ»‘åŠ¨åˆ‡æ¢ä¸Š/ä¸‹ä¸€ä¸ªå†…å®¹ï¼š

```tsx
// hooks/useSwipeNavigation.ts
"use client";

import { useEffect, useRef } from "react";
import { useRouter } from "next/navigation";

export function useSwipeNavigation(prevPath?: string, nextPath?: string) {
  const router = useRouter();
  const startX = useRef(0);
  const startY = useRef(0);

  useEffect(() => {
    const handleTouchStart = (e: TouchEvent) => {
      startX.current = e.touches[0].clientX;
      startY.current = e.touches[0].clientY;
    };

    const handleTouchEnd = (e: TouchEvent) => {
      const deltaX = e.changedTouches[0].clientX - startX.current;
      const deltaY = e.changedTouches[0].clientY - startY.current;

      // ç¡®ä¿æ˜¯æ°´å¹³æ»‘åŠ¨
      if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 80) {
        if (deltaX > 0 && prevPath) {
          router.push(prevPath);
        } else if (deltaX < 0 && nextPath) {
          router.push(nextPath);
        }
      }
    };

    document.addEventListener("touchstart", handleTouchStart, { passive: true });
    document.addEventListener("touchend", handleTouchEnd, { passive: true });

    return () => {
      document.removeEventListener("touchstart", handleTouchStart);
      document.removeEventListener("touchend", handleTouchEnd);
    };
  }, [prevPath, nextPath, router]);
}

// åœ¨è¯¦æƒ…é¡µä½¿ç”¨
function HookDetailPage() {
  const siblings = getSiblings(pathname);
  useSwipeNavigation(siblings.prev, siblings.next);

  return <div>...</div>;
}
```

### 4.2 è¾¹ç¼˜æ»‘åŠ¨è¿”å›

```tsx
// hooks/useEdgeSwipeBack.ts
export function useEdgeSwipeBack() {
  const router = useRouter();
  const startX = useRef(0);
  const isEdge = useRef(false);

  useEffect(() => {
    const handleTouchStart = (e: TouchEvent) => {
      const x = e.touches[0].clientX;
      isEdge.current = x < 20; // å·¦è¾¹ç¼˜ 20px
      startX.current = x;
    };

    const handleTouchEnd = (e: TouchEvent) => {
      if (!isEdge.current) return;

      const deltaX = e.changedTouches[0].clientX - startX.current;
      if (deltaX > 100) {
        router.back();
      }
    };

    document.addEventListener("touchstart", handleTouchStart, { passive: true });
    document.addEventListener("touchend", handleTouchEnd, { passive: true });

    return () => {
      document.removeEventListener("touchstart", handleTouchStart);
      document.removeEventListener("touchend", handleTouchEnd);
    };
  }, [router]);
}
```

---

## äº”ã€ä¸€çº§é¡µé¢è®¾è®¡

### 5.1 å­¦ä¹ ä¸­å¿ƒ (/learn)

æ•´åˆ React å’Œç®—æ³•åŸºç¡€å†…å®¹ï¼Œç”¨åˆ†åŒºå¡ç‰‡å±•ç¤ºï¼š

```tsx
// app/learn/page.tsx (ç§»åŠ¨ç«¯)
export default function LearnPage() {
  return (
    <div className="min-h-screen bg-zinc-950 pb-20">
      {/* é¡¶éƒ¨æœç´¢ */}
      <div className="sticky top-0 z-10 bg-zinc-950/95 backdrop-blur-xl p-4 pt-[env(safe-area-inset-top)]">
        <button className="w-full flex items-center gap-3 px-4 py-3 bg-zinc-900 rounded-xl text-zinc-500">
          <SearchIcon />
          <span>æœç´¢ Hookã€ç»„ä»¶ã€ç®—æ³•...</span>
        </button>
      </div>

      {/* åˆ†åŒºå¡ç‰‡ */}
      <div className="px-4 space-y-6">
        {/* React Hooks */}
        <Section
          title="React Hooks"
          icon="ğŸª"
          color="cyan"
          items={[
            { label: "useState", path: "/use-state" },
            { label: "useEffect", path: "/use-effect" },
            { label: "useRef", path: "/use-ref" },
          ]}
          viewAllPath="/hooks"
        />

        {/* React ç»„ä»¶ */}
        <Section
          title="ç»„ä»¶åŸºç¡€"
          icon="ğŸ§©"
          color="blue"
          items={[
            { label: "Props", path: "/props" },
            { label: "æ¡ä»¶æ¸²æŸ“", path: "/conditional-rendering" },
            { label: "åˆ—è¡¨æ¸²æŸ“", path: "/list-rendering" },
          ]}
          viewAllPath="/react-basics"
        />

        {/* æ•°æ®ç»“æ„ */}
        <Section
          title="æ•°æ®ç»“æ„"
          icon="ğŸ“¦"
          color="emerald"
          items={[
            { label: "æ ˆ", path: "/stack" },
            { label: "é˜Ÿåˆ—", path: "/queue" },
            { label: "é“¾è¡¨", path: "/linked-list" },
          ]}
          viewAllPath="/algorithms"
        />
      </div>
    </div>
  );
}

function Section({ title, icon, color, items, viewAllPath }) {
  return (
    <div>
      <div className="flex items-center justify-between mb-3">
        <h2 className="flex items-center gap-2 font-semibold">
          <span>{icon}</span>
          {title}
        </h2>
        <Link href={viewAllPath} className="text-sm text-zinc-500">
          æŸ¥çœ‹å…¨éƒ¨ â†’
        </Link>
      </div>
      <div className="grid grid-cols-3 gap-2">
        {items.map((item) => (
          <Link
            key={item.path}
            href={item.path}
            className="p-3 bg-zinc-900 rounded-xl text-center text-sm active:bg-zinc-800"
          >
            {item.label}
          </Link>
        ))}
      </div>
    </div>
  );
}
```

### 5.2 åˆ·é¢˜ä¸­å¿ƒ (/problems)

ç›´æ¥å¤ç”¨ç°æœ‰é¢˜åº“é¡µé¢ï¼Œä¼˜åŒ–ç§»åŠ¨ç«¯å¸ƒå±€ã€‚

### 5.3 æˆ‘çš„ (/profile)

```tsx
// app/profile/page.tsx
export default function ProfilePage() {
  return (
    <div className="min-h-screen bg-zinc-950 pb-20 pt-[env(safe-area-inset-top)]">
      {/* ç”¨æˆ·ä¿¡æ¯ */}
      <div className="p-4">
        <div className="flex items-center gap-4 p-4 bg-zinc-900 rounded-2xl">
          <div className="w-16 h-16 rounded-full bg-emerald-500/20 flex items-center justify-center text-2xl">
            ğŸ‘¨â€ğŸ’»
          </div>
          <div>
            <h2 className="font-semibold text-lg">å­¦ä¹ è€…</h2>
            <p className="text-sm text-zinc-500">å·²å­¦ä¹  30 å¤©</p>
          </div>
        </div>
      </div>

      {/* å­¦ä¹ ç»Ÿè®¡ */}
      <div className="px-4 mb-6">
        <div className="grid grid-cols-3 gap-3">
          <StatCard label="å·²å®Œæˆ" value="45" unit="é¢˜" />
          <StatCard label="å­¦ä¹ æ—¶é•¿" value="12" unit="å°æ—¶" />
          <StatCard label="è¿ç»­æ‰“å¡" value="7" unit="å¤©" />
        </div>
      </div>

      {/* åŠŸèƒ½åˆ—è¡¨ */}
      <div className="px-4">
        <MenuItem icon="â­" label="æˆ‘çš„æ”¶è—" path="/profile/favorites" />
        <MenuItem icon="ğŸ“" label="å­¦ä¹ è®°å½•" path="/profile/history" />
        <MenuItem icon="ğŸ¯" label="å­¦ä¹ ç›®æ ‡" path="/profile/goals" />
        <MenuItem icon="âš™ï¸" label="è®¾ç½®" path="/profile/settings" />
      </div>
    </div>
  );
}
```

---

## å…­ã€è·¯ç”±é…ç½®

```typescript
// lib/mobile-routes.ts

export const mobileRouteConfig = {
  // ä¸€çº§é¡µé¢ï¼ˆæ˜¾ç¤ºä¸» Tabï¼‰
  primaryPaths: ["/", "/learn", "/problems", "/profile"],

  // åŒçº§é¡µé¢åˆ†ç»„ï¼ˆç”¨äºä¸Šä¸‹åˆ‡æ¢ï¼‰
  siblingGroups: {
    hooks: [
      "/use-state", "/use-effect", "/use-ref", "/use-context",
      "/use-reducer", "/use-memo", "/use-callback", // ...
    ],
    components: [
      "/component-basics", "/props", "/children", "/conditional-rendering",
      "/list-rendering", "/event-handling", "/forms", // ...
    ],
    // é¢˜ç›®åˆ†ç»„æŒ‰åˆ†ç±»åŠ¨æ€ç”Ÿæˆ
  },

  // è·å–åŒçº§å¯¼èˆª
  getSiblings(pathname: string) {
    for (const [group, paths] of Object.entries(this.siblingGroups)) {
      const index = paths.indexOf(pathname);
      if (index !== -1) {
        return {
          prev: paths[index - 1],
          next: paths[index + 1],
          current: index + 1,
          total: paths.length,
        };
      }
    }
    return null;
  },
};
```

---

## ä¸ƒã€å®æ–½æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ™ºèƒ½å¯¼èˆªç»„ä»¶
- [ ] å®ç° `SmartBottomNav` ç»„ä»¶
- [ ] é…ç½®ä¸€çº§é¡µé¢è·¯å¾„åˆ¤æ–­
- [ ] é…ç½®åŒçº§é¡µé¢åˆ†ç»„

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºä¸€çº§é¡µé¢
- [ ] åˆ›å»º `/learn` å­¦ä¹ ä¸­å¿ƒé¡µé¢
- [ ] åˆ›å»º `/profile` ä¸ªäººä¸­å¿ƒé¡µé¢
- [ ] ä¼˜åŒ– `/problems` ç§»åŠ¨ç«¯å¸ƒå±€

### ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ æ‰‹åŠ¿æ”¯æŒ
- [ ] å®ç°å·¦å³æ»‘åŠ¨åˆ‡æ¢
- [ ] å®ç°è¾¹ç¼˜æ»‘åŠ¨è¿”å›

### ç¬¬å››æ­¥ï¼šæµ‹è¯•ä¼˜åŒ–
- [ ] iOS Safari æµ‹è¯•
- [ ] Android Chrome æµ‹è¯•
- [ ] å®‰å…¨åŒºåŸŸé€‚é…

---

## å…«ã€è®¾è®¡è§„èŒƒ

| å±æ€§ | å€¼ |
|------|-----|
| å¯¼èˆªæ é«˜åº¦ | 56px + safe-area |
| æœ€å°è§¦æ‘¸ç›®æ ‡ | 44Ã—44px |
| é¡µé¢è¾¹è· | 16px |
| å¡ç‰‡åœ†è§’ | 12px / 16px |
| åŠ¨ç”»æ—¶é•¿ | 200ms |
| èƒŒæ™¯è‰² | #09090b |
| å¡ç‰‡èƒŒæ™¯ | #18181b |
